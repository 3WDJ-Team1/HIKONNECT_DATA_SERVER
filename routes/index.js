/**
 * 
 */
var express = require('express');
var router = express.Router();
var fs = require('fs');
var proj4 = require('proj4');
var net = require('net');

/* GET home page. */
router.get('/', function(req, res, next) {
  res.render('index', { title: 'Express' });
});

/**
 * @function      This function returns hiking route's coordinates converted from 
 *                TM projection to GRS80 Projection(degrees).
 *                HTTP request URL = host:3000/paths/{mntCode}/{fid}
 * 
 * @param String  req.params.mntCode  Mountain's serial code.
 * @param String  req.params.fid      Feature's ID.
 * 
 * @const String  KTM_PROJ            KTM Projection(Korean) Setting for converting.
 * @const String  EPSG4019            GRS80 Projection setting for converting.  
 * 
 * @var   Array   coordinateFilePath  Coordinate file path in local storage.
 * @var   Array   coordinateFiles     Coordinate file list in local storage.
 * @var   String  mntFileName         Selected file name.
 * @var   Array   coordinateFile      JSON Object in local storage.
 *                                    This contains short description that hiking path.
 * @var   Array   mntPaths            Coordinates list in local file.
 * 
 * @return  null
 *          HTTP Response = String    The String is formatted by JSON syntax.
 */
router.get('/paths/:mntCode/:fid?', function(req, res, next) {
  // TM Projectrion Setting (Korean)
  const KTM_PROJ = '+proj=tmerc +lat_0=38 +lon_0=127 +k=1 +x_0=200000 +y_0=600000 +ellps=GRS80 +units=m +no_defs';

  // GRS80 Projection Setting
  const EPSG4019 = '+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs';

  var mntCode = req.params.mntCode;
  var fid = req.params.fid;

  // Hiking paths directory in local
  let coordinateFilePath = `public/mountain/${mntCode}_geojson`;

  // Hiking path files path in local
  fs.readdir(coordinateFilePath, (err, coordinateFiles) => {
    if (coordinateFiles == undefined) {
      return res.sendStatus(404);
    }

    coordinateFiles.forEach((fileName, idx, arr) => {
      let mntFileName;

      if (fileName.match(/^PMNTN_SPOT_/) || fileName.match(/^PMNTN_SAFE_SPOT_/)) {
        return;
      }
      mntFileName = fileName;

      fs.readFile(
        `${coordinateFilePath}/${mntFileName}`, 
        {encoding: 'utf8'}, 
        (err, coordinateFile) => {
          // Hiking paths in file
          var mntPaths = JSON.parse(coordinateFile)['features'];

          Promise.all(mntPaths.map((data) => {
              let idx = data['attributes']['fid'];

              var routePaths = data['geometry']['paths'][0];

              routePaths.map((data, idx) => {
                let coordinate = proj4(KTM_PROJ, EPSG4019).forward(data);
                
                data = {
                  lat: coordinate[1],
                  lng: coordinate[0],
                }
                routePaths[idx] = data;
              });
          }))
          .then(() => {
            if (fid == undefined) {
              return res.json(mntPaths);
            } else if (mntPaths[fid] != undefined) {
              return res.json(mntPaths[fid]);
            } else {
              return res.sendStatus(404);
            }
          });
      });
    });
  });
});

/**
 * 
 */
router.get('/dummy/school', (req, res, next) => {
  const DUMMY_DATA = [
    {"attributes":{"FID":2,"PMNTN_SN":32658,"MNTN_CODE":"438001301","MNTN_NM":"소백산_비로봉","PMNTN_NM":"천동리구간","PMNTN_MAIN":" ","PMNTN_LT":9.21,"PMNTN_DFFL":"쉬움","PMNTN_UPPL":345,"PMNTN_GODN":242,"PMNTN_MTRQ":" ","PMNTN_CNRL":" ","PMNTN_CLS_":" ","PMNTN_RISK":" ","PMNTN_RECO":" ","DATA_STDR_":"2016-12-31","MNTN_ID":"438001301"},"geometry":{"paths":[[{"lat":36.934151655741104,"lng":128.4606656586206},{"lat":36.93420077356173,"lng":128.46053914708668},{"lat":36.934187171190764,"lng":128.46048052671182},{"lat":36.934157573263654,"lng":128.46036910095927},{"lat":36.93414648204102,"lng":128.46029005478212},{"lat":36.93415870739706,"lng":128.46022883604346},{"lat":36.93420590767789,"lng":128.46019435840682},{"lat":36.93426474264398,"lng":128.46017171663146},{"lat":36.934323577605724,"lng":128.4601490748222},{"lat":36.93434502088519,"lng":128.4601084289761},{"lat":36.934336653261056,"lng":128.45998265697855},{"lat":36.93433563003477,"lng":128.45981898475625},{"lat":36.934413686448615,"lng":128.4591594804094},{"lat":36.93449027689061,"lng":128.4586811510324},{"lat":36.93453486046295,"lng":128.45838945977917},{"lat":36.934547591601266,"lng":128.45797462454254},{"lat":36.93459785473753,"lng":128.45756025872586},{"lat":36.93460162351976,"lng":128.45709270590189},{"lat":36.93459989845884,"lng":128.45672444934428},{"lat":36.93463664689823,"lng":128.45623977348163},{"lat":36.93465203941108,"lng":128.45607630568082},{"lat":36.93463885822894,"lng":128.45596508596284},{"lat":36.934602006856494,"lng":128.45587987316813},{"lat":36.9345277865751,"lng":128.4557737363047},{"lat":36.93433836129495,"lng":128.45569830854208},{"lat":36.934078772311736,"lng":128.4555957027967},{"lat":36.93386893958282,"lng":128.45543234699986},{"lat":36.93365176352743,"lng":128.45530689249125},{"lat":36.9335047510764,"lng":128.45520861645136},{"lat":36.93332123897073,"lng":128.454981297462},{"lat":36.93318391501406,"lng":128.4548451515519},{"lat":36.933035167036046,"lng":128.45467087191093},{"lat":36.932888764631954,"lng":128.45449662220182},{"lat":36.93280133675377,"lng":128.45428219441902},{"lat":36.9327553120375,"lng":128.45417056825917},{"lat":36.93271151568917,"lng":128.45407358215115},{"lat":36.93259267573761,"lng":128.45397273842238},{"lat":36.932293722019125,"lng":128.45380535735063},{"lat":36.93204832356596,"lng":128.4536883257009},{"lat":36.93186382307963,"lng":128.45358374306224},{"lat":36.931686500771775,"lng":128.453461716016},{"lat":36.931442133886286,"lng":128.45321611455842},{"lat":36.93132446552437,"lng":128.45296916967365},{"lat":36.931180875141415,"lng":128.45273651476091},{"lat":36.931105102884466,"lng":128.4525310059304},{"lat":36.93109517794152,"lng":128.4523058601579},{"lat":36.93108999110945,"lng":128.45207492863858},{"lat":36.93107697003401,"lng":128.45194326018995},{"lat":36.93105217274902,"lng":128.45181729008442},{"lat":36.9310368289548,"lng":128.45168267049894},{"lat":36.93103077474662,"lng":128.45155985590492},{"lat":36.93102758121722,"lng":128.45137278486146},{"lat":36.93109096030467,"lng":128.45107549113004},{"lat":36.931208363294765,"lng":128.45077010082005},{"lat":36.931386734133824,"lng":128.4504683889899},{"lat":36.931437540127256,"lng":128.45027614273104},{"lat":36.931438405128006,"lng":128.45016802538248},{"lat":36.93140872727438,"lng":128.45006537369815},{"lat":36.93134838971709,"lng":128.44998279823193},{"lat":36.93124814933276,"lng":128.44990265009017},{"lat":36.93108429059576,"lng":128.44985678115654},{"lat":36.93099800836114,"lng":128.4497914184748},{"lat":36.93082138288827,"lng":128.4495817395295},{"lat":36.93072432898036,"lng":128.44939642727212},{"lat":36.93069662259412,"lng":128.44934055893552},{"lat":36.93064346217357,"lng":128.4492405397166},{"lat":36.93057653014148,"lng":128.44910235935174},{"lat":36.930530663880575,"lng":128.4489702850751},{"lat":36.93046666094404,"lng":128.44875908285744},{"lat":36.93041408348415,"lng":128.44858601301658},{"lat":36.9303050187418,"lng":128.44843562224958},{"lat":36.93019119211364,"lng":128.44829393992313},{"lat":36.92997292172049,"lng":128.44801069274183},{"lat":36.92983336018308,"lng":128.44785992604676},{"lat":36.929665345146304,"lng":128.44774679771967},{"lat":36.92955435305935,"lng":128.44754378420592},{"lat":36.92949696554383,"lng":128.447385269268},{"lat":36.92945815817649,"lng":128.44725036292215},{"lat":36.929450475795505,"lng":128.44703693955358},{"lat":36.92945682154083,"lng":128.4468295343446},{"lat":36.929489576756716,"lng":128.44654647569078},{"lat":36.92947176466095,"lng":128.44642644087662},{"lat":36.929414817946686,"lng":128.44621240859993},{"lat":36.929322054680945,"lng":128.4460768361502},{"lat":36.92919412677061,"lng":128.44593790720504},{"lat":36.929009805202035,"lng":128.44580997113732},{"lat":36.928792734631976,"lng":128.44566994200915},{"lat":36.928603674518364,"lng":128.44554779329548},{"lat":36.92848814966167,"lng":128.44532427392576},{"lat":36.92838823387503,"lng":128.44490807841186},{"lat":36.92835451163064,"lng":128.44442841083125},{"lat":36.928340111576674,"lng":128.44387884757458},{"lat":36.9283669595555,"lng":128.44345252791103},{"lat":36.928406442601045,"lng":128.44320754411095},{"lat":36.928487964904534,"lng":128.44298645604053},{"lat":36.92886157851198,"lng":128.4426170059137},{"lat":36.92913067522494,"lng":128.44240991423166},{"lat":36.929206948038775,"lng":128.44225889374962},{"lat":36.929279038848335,"lng":128.44204353089444},{"lat":36.92928493561166,"lng":128.44189164383712},{"lat":36.92928149510538,"lng":128.44173379728548},{"lat":36.92924177151509,"lng":128.44141770032377},{"lat":36.929243207335986,"lng":128.44123653544278},{"lat":36.92923930289718,"lng":128.44113712927327},{"lat":36.92925890321415,"lng":128.4410321674563},{"lat":36.929325420513536,"lng":128.44092778226593},{"lat":36.92947736053307,"lng":128.44070170981968},{"lat":36.92964268109183,"lng":128.44056347030207},{"lat":36.92967245095144,"lng":128.44035927398994},{"lat":36.92951399699968,"lng":128.44022290126625},{"lat":36.92924331190959,"lng":128.44003839406685},{"lat":36.92893564773592,"lng":128.43978329928345},{"lat":36.92880901782417,"lng":128.43977590016226},{"lat":36.92866794285523,"lng":128.43981508017967},{"lat":36.928390114612235,"lng":128.43994024912632},{"lat":36.928319322729735,"lng":128.43999198068283},{"lat":36.92822474850286,"lng":128.44008433175554},{"lat":36.92813904875791,"lng":128.4402410812475},{"lat":36.9280258463034,"lng":128.44031566946728},{"lat":36.92797879041212,"lng":128.44033262498826},{"lat":36.9277012855337,"lng":128.4404168835865},{"lat":36.92761697357325,"lng":128.44039831446653},{"lat":36.92748105280248,"lng":128.44037911144972},{"lat":36.927148589129395,"lng":128.4402932055126},{"lat":36.926881346703595,"lng":128.44026654551809},{"lat":36.92676400768401,"lng":128.44027094879678},{"lat":36.92670269160754,"lng":128.44031110655726},{"lat":36.926650805204325,"lng":128.44034553567656},{"lat":36.926617639365006,"lng":128.44038603909567},{"lat":36.92661736175363,"lng":128.44042110207326},{"lat":36.92664467911798,"lng":128.4405266368316},{"lat":36.9266721815045,"lng":128.44060879632988},{"lat":36.92669480699004,"lng":128.44071427357787},{"lat":36.9266987581199,"lng":128.44080783259133},{"lat":36.926670283835314,"lng":128.44084839348943},{"lat":36.926550259464584,"lng":128.44119173763588},{"lat":36.92632269538997,"lng":128.4414870031625},{"lat":36.92605387820543,"lng":128.4416590280368},{"lat":36.925551355682224,"lng":128.44171713475143},{"lat":36.92533507371682,"lng":128.44177291745743},{"lat":36.92523654781764,"lng":128.44177170551416},{"lat":36.92510034923595,"lng":128.44178756302236},{"lat":36.924874359439485,"lng":128.44188413565666},{"lat":36.92454543000762,"lng":128.44194437581743},{"lat":36.924353394286776,"lng":128.44190110370525},{"lat":36.92411922582276,"lng":128.44184562511762},{"lat":36.923779238990406,"lng":128.44182098827707},{"lat":36.92343639658727,"lng":128.4418606022627},{"lat":36.9234081073105,"lng":128.44187778673083},{"lat":36.9233676021846,"lng":128.44195618447864},{"lat":36.92335043969693,"lng":128.4420494797045},{"lat":36.923302363851235,"lng":128.44219499180392},{"lat":36.92325247509826,"lng":128.44227327379616},{"lat":36.92320541892196,"lng":128.44229022711477},{"lat":36.92316075495676,"lng":128.44230136572043},{"lat":36.92305045340182,"lng":128.44230585239882},{"lat":36.922869567569855,"lng":128.4423357689063},{"lat":36.92263389251206,"lng":128.44247020464397},{"lat":36.922464249038555,"lng":128.44256162184203},{"lat":36.92239150433783,"lng":128.4425636484078},{"lat":36.92206364099539,"lng":128.4424894839181},{"lat":36.92184299147188,"lng":128.44250430012545},{"lat":36.92154478959855,"lng":128.44253569371028},{"lat":36.92120742684466,"lng":128.4424760232821},{"lat":36.92078345280263,"lng":128.4423919116665},{"lat":36.92056744859534,"lng":128.44241262909344},{"lat":36.920445510433375,"lng":128.44240528447838},{"lat":36.92021887093054,"lng":128.4425836564362},{"lat":36.919786402330004,"lng":128.4429786386589},{"lat":36.91937934239437,"lng":128.44342360214375},{"lat":36.91916895992663,"lng":128.44362262237283},{"lat":36.9189188136539,"lng":128.44380654192017},{"lat":36.91862342248279,"lng":128.4440746374546},{"lat":36.91835381190768,"lng":128.4443459707284},{"lat":36.91823152545402,"lng":128.4443824471996},{"lat":36.91797378326418,"lng":128.4443412845391},{"lat":36.917816773499574,"lng":128.44431889541949},{"lat":36.917713160986764,"lng":128.44436728939985},{"lat":36.91734592986375,"lng":128.4445234624473},{"lat":36.917188501967715,"lng":128.4445536610953},{"lat":36.917076063492125,"lng":128.44453182150806},{"lat":36.91694755245977,"lng":128.44446595633573},{"lat":36.91686105774926,"lng":128.4444269059351},{"lat":36.916710783576484,"lng":128.44444258373287},{"lat":36.91642379930035,"lng":128.44453838623238},{"lat":36.91621722455165,"lng":128.44455336938395},{"lat":36.915973441317824,"lng":128.4445269884869},{"lat":36.91584676506182,"lng":128.44452542624958},{"lat":36.91572478051638,"lng":128.4445239218821},{"lat":36.91564989893818,"lng":128.4444996241788},{"lat":36.915514768351656,"lng":128.4443810867769},{"lat":36.915412200951806,"lng":128.44429801250845},{"lat":36.91531418586982,"lng":128.44423252518678},{"lat":36.91520669443577,"lng":128.44417860826547},{"lat":36.91514584147527,"lng":128.44416032753043},{"lat":36.91506617521323,"lng":128.44414765842592},{"lat":36.91494419063842,"lng":128.4441461547027},{"lat":36.914864431492035,"lng":128.44414517150395},{"lat":36.914572662780344,"lng":128.4442526009331},{"lat":36.9144228994597,"lng":128.44420400688406},{"lat":36.91420735922245,"lng":128.4441662891022},{"lat":36.914071624559334,"lng":128.44412371182997},{"lat":36.91395465673711,"lng":128.44408136603062},{"lat":36.91383736385254,"lng":128.44407992030258},{"lat":36.9137249019865,"lng":128.4440610038924},{"lat":36.9135425751306,"lng":128.44397694906533},{"lat":36.91335105047366,"lng":128.44386940776764},{"lat":36.913247925567376,"lng":128.4438564502326},{"lat":36.9131351851044,"lng":128.443872591085},{"lat":36.91305105917654,"lng":128.44383065090028},{"lat":36.91299508353036,"lng":128.44378905766536},{"lat":36.912939850526364,"lng":128.44365398000483},{"lat":36.91288461736551,"lng":128.44351890253657},{"lat":36.912829384047775,"lng":128.4433838252606},{"lat":36.91274600026869,"lng":128.44324840152237},{"lat":36.91269531919128,"lng":128.44313091073718},{"lat":36.912659594355276,"lng":128.44290258094324},{"lat":36.91264328503692,"lng":128.44259268367966},{"lat":36.91262107809482,"lng":128.44243464053412},{"lat":36.91258893133413,"lng":128.44234659511682},{"lat":36.91254321912533,"lng":128.4421941063486},{"lat":36.91250192042751,"lng":128.4420767319592},{"lat":36.91243210064662,"lng":128.44200575347452},{"lat":36.91238532244813,"lng":128.44198764826234},{"lat":36.91234783502385,"lng":128.44198134394242},{"lat":36.91227694957528,"lng":128.4420447485449},{"lat":36.912110283303434,"lng":128.44235239316737},{"lat":36.911982494433445,"lng":128.44249105977656},{"lat":36.91172682348069,"lng":128.44278007698912},{"lat":36.911599776106165,"lng":128.4428252593195},{"lat":36.91140267753768,"lng":128.4428286766044},{"lat":36.91110231476801,"lng":128.4428366660936},{"lat":36.910768785338185,"lng":128.4428851496318},{"lat":36.91064652238444,"lng":128.44291870379485},{"lat":36.910533781988335,"lng":128.44293484556601},{"lat":36.910388756048306,"lng":128.4428804719787},{"lat":36.91027188039672,"lng":128.4428264450707},{"lat":36.91020210738493,"lng":128.4427496254502},{"lat":36.910099585003216,"lng":128.44266071669404},{"lat":36.910034271804,"lng":128.4426131679314},{"lat":36.90995938971211,"lng":128.44258887401472},{"lat":36.90987020066336,"lng":128.44259361970475},{"lat":36.90970561956654,"lng":128.4426383394618},{"lat":36.909573834133376,"lng":128.4426893057006},{"lat":36.90944743584383,"lng":128.44265269176958},{"lat":36.909391366993745,"lng":128.44262278642438},{"lat":36.90923705013364,"lng":128.44255661382954},{"lat":36.90900334477521,"lng":128.44244272038284},{"lat":36.90881715895797,"lng":128.44225345266673},{"lat":36.908686624823424,"lng":128.44214667263327},{"lat":36.908630694829,"lng":128.44209924060132},{"lat":36.90851358710008,"lng":128.44207442840462},{"lat":36.90835379054577,"lng":128.44210752138386},{"lat":36.90810043752868,"lng":128.4421044057834},{"lat":36.907969254619815,"lng":128.44207942068587},{"lat":36.90757138472079,"lng":128.4419576692552},{"lat":36.9071789937455,"lng":128.44173665695578},{"lat":36.90690301561674,"lng":128.4416280925385},{"lat":36.90664998664692,"lng":128.44158408255717},{"lat":36.90654727804639,"lng":128.44151854875523},{"lat":36.9064729975414,"lng":128.44141830730035},{"lat":36.906412699538684,"lng":128.4413299235458},{"lat":36.90616974819028,"lng":128.4411983961232},{"lat":36.90611827806672,"lng":128.4411802353299},{"lat":36.90601064608326,"lng":128.44114385618587},{"lat":36.90597798913344,"lng":128.44112008374142},{"lat":36.90590393964947,"lng":128.44099063218036},{"lat":36.905653408681566,"lng":128.4406311445464},{"lat":36.90532532436278,"lng":128.44028823583793},{"lat":36.90511728229525,"lng":128.44019219855318},{"lat":36.905035870556176,"lng":128.44010355827933},{"lat":36.905005975300945,"lng":128.44002723573402},{"lat":36.90499772432019,"lng":128.43988398717332},{"lat":36.90500099452594,"lng":128.4397671723191},{"lat":36.905011417729874,"lng":128.43963583830455},{"lat":36.90501222632177,"lng":128.43953360010542},{"lat":36.90501285003256,"lng":128.4394547306347},{"lat":36.90499696024982,"lng":128.43938734419717},{"lat":36.90495305863036,"lng":128.43930208613727},{"lat":36.90490151889857,"lng":128.43929269018025},{"lat":36.90479353984521,"lng":128.43930013054077},{"lat":36.904584804089744,"lng":128.43929172888258},{"lat":36.90447703288608,"lng":128.43927287958203},{"lat":36.90436967735995,"lng":128.4392014511278},{"lat":36.90431342279101,"lng":128.43919491887385},{"lat":36.90418191580517,"lng":128.43921083496318},{"lat":36.9040877579037,"lng":128.43925057954516},{"lat":36.90396098882555,"lng":128.43926071091065},{"lat":36.90386255487544,"lng":128.43924781894555},{"lat":36.903764767507795,"lng":128.43915313777927},{"lat":36.90370892855864,"lng":128.43909402686387},{"lat":36.903659766644516,"lng":128.43878376405982},{"lat":36.90365130641401,"lng":128.4386668074834},{"lat":36.9036708118396,"lng":128.4385735640736},{"lat":36.90374220312615,"lng":128.43844590020134},{"lat":36.90377146098026,"lng":128.43830603481308},{"lat":36.90373972616316,"lng":128.43816542252006},{"lat":36.903731403708505,"lng":128.43803093961313},{"lat":36.903732095588516,"lng":128.4379433082947},{"lat":36.903765675645346,"lng":128.4378502368696},{"lat":36.9038372045011,"lng":128.43770504586115},{"lat":36.903861585335655,"lng":128.43758849098307},{"lat":36.90385317003108,"lng":128.4374656921064},{"lat":36.90379802164725,"lng":128.43731895092347},{"lat":36.90371495310479,"lng":128.4371426551999},{"lat":36.903655112580665,"lng":128.43699585713378},{"lat":36.90358984299372,"lng":128.4369424751922},{"lat":36.903519697360785,"lng":128.43691240426944},{"lat":36.90342130917654,"lng":128.43689367333644},{"lat":36.90328069538569,"lng":128.4368744261629},{"lat":36.90319629025199,"lng":128.4368675515345},{"lat":36.90313065205102,"lng":128.43686090638116},{"lat":36.90291575362152,"lng":128.43674142707528},{"lat":36.90281299608945,"lng":128.43668174503048},{"lat":36.902668012914575,"lng":128.43662154700758},{"lat":36.90262132585246,"lng":128.43659176349166},{"lat":36.902551318270255,"lng":128.4365441672866},{"lat":36.902485910299575,"lng":128.4365083125011},{"lat":36.902406196861534,"lng":128.43650149570692},{"lat":36.90237321656481,"lng":128.43651862028068},{"lat":36.90229764222473,"lng":128.4365819646017},{"lat":36.90227363087453,"lng":128.43665178162198},{"lat":36.90225417303242,"lng":128.43673918188395},{"lat":36.902244236794125,"lng":128.436809170892},{"lat":36.90224303898546,"lng":128.43696106227554},{"lat":36.90222348876159,"lng":128.43706014636825},{"lat":36.90219455498774,"lng":128.43715911564703},{"lat":36.902141932020456,"lng":128.43728700775517},{"lat":36.902070864643576,"lng":128.43737377636464},{"lat":36.90173246056997,"lng":128.43744558922697},{"lat":36.90152528669567,"lng":128.4375365344834},{"lat":36.90114727366876,"lng":128.4378707720279},{"lat":36.900982048347295,"lng":128.43799728358397},{"lat":36.90084575744826,"lng":128.4380248274704},{"lat":36.90070932816385,"lng":128.43806989683614},{"lat":36.900628922893645,"lng":128.4381507063854},{"lat":36.900505830611856,"lng":128.4382894171942},{"lat":36.90040095136419,"lng":128.43849845937564},{"lat":36.900311346943,"lng":128.4385557859183},{"lat":36.900213051280645,"lng":128.43852537011733},{"lat":36.90019534567429,"lng":128.43839077847414},{"lat":36.900212880676264,"lng":128.4379528143902},{"lat":36.90019794069832,"lng":128.4374677137269},{"lat":36.90018263015029,"lng":128.43702934776167},{"lat":36.900169983112754,"lng":128.43684807929543},{"lat":36.90015867131881,"lng":128.43649739816652},{"lat":36.90016097337411,"lng":128.4362053072498},{"lat":36.90016244631279,"lng":128.43601836904566},{"lat":36.90018429627612,"lng":128.43562719626806},{"lat":36.90023535299369,"lng":128.43510200479474},{"lat":36.90021350341658,"lng":128.4348972546791},{"lat":36.90016713764503,"lng":128.4348265804413},{"lat":36.900073532696446,"lng":128.43479622669642},{"lat":36.89997505214457,"lng":128.43478918302583},{"lat":36.8998434995957,"lng":128.43481094774728},{"lat":36.899659648390646,"lng":128.43491970957461},{"lat":36.899399993623234,"lng":128.43512102317493},{"lat":36.89927727269953,"lng":128.4352130027226},{"lat":36.899164487026546,"lng":128.43523499556935},{"lat":36.899071479930306,"lng":128.43512869916628}]]}},
    {"attributes":{"FID":14,"PMNTN_SN":32670,"MNTN_CODE":"438001301","MNTN_NM":"소백산_비로봉","PMNTN_NM":"어의곡리구간","PMNTN_MAIN":" ","PMNTN_LT":5.27,"PMNTN_DFFL":"쉬움","PMNTN_UPPL":93,"PMNTN_GODN":65,"PMNTN_MTRQ":" ","PMNTN_CNRL":" ","PMNTN_CLS_":" ","PMNTN_RISK":" ","PMNTN_RECO":" ","DATA_STDR_":"2016-12-31","MNTN_ID":"438001301"},"geometry":{"paths":[[{"lat":36.95792087430094,"lng":128.47875547508974},{"lat":36.957914519104726,"lng":128.47870624530867},{"lat":36.957932918431204,"lng":128.47866154617222},{"lat":36.957973783010644,"lng":128.47862555931076},{"lat":36.95803283933462,"lng":128.4785701462461},{"lat":36.958078280673114,"lng":128.47852579253123},{"lat":36.958119261489145,"lng":128.47847576581796},{"lat":36.95816479581488,"lng":128.4784201797718},{"lat":36.95818563323344,"lng":128.47835304378867},{"lat":36.95821107064184,"lng":128.47827473236018},{"lat":36.9582434075701,"lng":128.47817965830356},{"lat":36.95827567466088,"lng":128.47809301003068},{"lat":36.95830145879706,"lng":128.47797257577167},{"lat":36.958340255171606,"lng":128.4779140948885},{"lat":36.95838852858249,"lng":128.47779956620633},{"lat":36.95840053666687,"lng":128.4777098483496},{"lat":36.95840796190378,"lng":128.47762920114945},{"lat":36.95843825258398,"lng":128.47750882441375},{"lat":36.95844786797869,"lng":128.4774359281581},{"lat":36.95844879275831,"lng":128.47732360086246},{"lat":36.95845378488642,"lng":128.47726468758492},{"lat":36.958477082857605,"lng":128.477172306745},{"lat":36.958496151542256,"lng":128.47704616998834},{"lat":36.95853752474786,"lng":128.47694840213504},{"lat":36.95857206813706,"lng":128.47685897328927},{"lat":36.95862024770066,"lng":128.47675567474116},{"lat":36.958666382135526,"lng":128.47662707499578},{"lat":36.95872771382363,"lng":128.47656888126903},{"lat":36.95879371408478,"lng":128.4764910870219},{"lat":36.95885732199298,"lng":128.47643011223408},{"lat":36.95892302225428,"lng":128.4763888245794},{"lat":36.95903147085057,"lng":128.47635650778668},{"lat":36.95907224283813,"lng":128.47633175155764},{"lat":36.9591517416819,"lng":128.47625693780316},{"lat":36.95918619175839,"lng":128.47617874030365},{"lat":36.95922038836365,"lng":128.47613143240352},{"lat":36.9592792579534,"lng":128.47609848242345},{"lat":36.95935864065267,"lng":128.47603770930183},{"lat":36.959401874428245,"lng":128.47598770819846},{"lat":36.95942956337008,"lng":128.47590942359417},{"lat":36.959452676560986,"lng":128.47583950602353},{"lat":36.95950064741397,"lng":128.47576148030853},{"lat":36.959523783704434,"lng":128.47568875507778},{"lat":36.95954039511129,"lng":128.4755871592418},{"lat":36.959534442158215,"lng":128.47548878582253},{"lat":36.9595353419256,"lng":128.47537926663793},{"lat":36.95955203978086,"lng":128.47526713986943},{"lat":36.95957301364935,"lng":128.47518315195023},{"lat":36.95957837380627,"lng":128.47507930556097},{"lat":36.959590702515484,"lng":128.47495027220535},{"lat":36.95959827006792,"lng":128.4748520720005},{"lat":36.95959698482234,"lng":128.47473409779371},{"lat":36.959602068357576,"lng":128.47466395096734},{"lat":36.95958691618099,"lng":128.47458792809263},{"lat":36.959571970631664,"lng":128.47448663163868},{"lat":36.95955914087229,"lng":128.47440221390332},{"lat":36.95955287562614,"lng":128.47434175089768},{"lat":36.95956271889546,"lng":128.47424077083812},{"lat":36.959581415826015,"lng":128.4741595624298},{"lat":36.9595846832089,"lng":128.47403602971187},{"lat":36.95958305166471,"lng":128.47396018005517},{"lat":36.95958388058582,"lng":128.4738590845143},{"lat":36.959569280698915,"lng":128.47371566590917},{"lat":36.959563716925686,"lng":128.47356955288623},{"lat":36.95956463806942,"lng":128.47345722490203},{"lat":36.959574406069144,"lng":128.47336537121055},{"lat":36.9595888258492,"lng":128.4732560226145},{"lat":36.95960335937759,"lng":128.47313263392485},{"lat":36.959608810258935,"lng":128.47301755482766},{"lat":36.959619228771366,"lng":128.47284636874545},{"lat":36.95964017779956,"lng":128.47276518983097},{"lat":36.959663426999896,"lng":128.47267842120917},{"lat":36.95965298683016,"lng":128.47257718258626},{"lat":36.95963785641844,"lng":128.4724983524728},{"lat":36.95963394682661,"lng":128.4724252815066},{"lat":36.9596524816166,"lng":128.4723637310623},{"lat":36.95968207727894,"lng":128.4723275959977},{"lat":36.959698265617845,"lng":128.47227724916067},{"lat":36.959703347720655,"lng":128.47220710090616},{"lat":36.95969481627573,"lng":128.4721480145957},{"lat":36.95966616362975,"lng":128.47206901174036},{"lat":36.959650963558815,"lng":128.47199860661786},{"lat":36.959619942232976,"lng":128.47193361622806},{"lat":36.959613824522044,"lng":128.47185490138955},{"lat":36.959614537051586,"lng":128.47176784688773},{"lat":36.95963084066351,"lng":128.47170345769584},{"lat":36.95965181292037,"lng":128.47161946976675},{"lat":36.959650202932885,"lng":128.47154081136242},{"lat":36.95963500165911,"lng":128.47147040520926},{"lat":36.959621939729885,"lng":128.47141407015397},{"lat":36.95961366098339,"lng":128.47132409298848},{"lat":36.95962320336635,"lng":128.4712596185019},{"lat":36.95963493041038,"lng":128.4712035976901},{"lat":36.95965148674604,"lng":128.47110831846166},{"lat":36.959656504896955,"lng":128.47104589346353},{"lat":36.95967078406136,"lng":128.4709533940827},{"lat":36.959680579206946,"lng":128.47085802959154},{"lat":36.95970575879693,"lng":128.47081060502285},{"lat":36.95972663813098,"lng":128.47073784923484},{"lat":36.95972969520675,"lng":128.470639589696},{"lat":36.9597190935976,"lng":128.4705580086557},{"lat":36.95971755121911,"lng":128.4704709252352},{"lat":36.95972279281459,"lng":128.4703811204927},{"lat":36.95974843083187,"lng":128.47027753096634},{"lat":36.9597827626217,"lng":128.47021337123974},{"lat":36.95981730104232,"lng":128.47012393661728},{"lat":36.95984058755025,"lng":128.4700322533843},{"lat":36.959888486396345,"lng":128.4699626484729},{"lat":36.95993886792059,"lng":128.46986498974402},{"lat":36.959971152111116,"lng":128.46977552716322},{"lat":36.95998996127588,"lng":128.4696802759012},{"lat":36.959990786550634,"lng":128.46957918077408},{"lat":36.95999605054569,"lng":128.46948656580972},{"lat":36.96001481247989,"lng":128.46939693181181},{"lat":36.96001775414367,"lng":128.46931271306292},{"lat":36.95999588270895,"lng":128.4692309894157},{"lat":36.95994915391968,"lng":128.46915737612503},{"lat":36.95988892614725,"lng":128.46908078310744},{"lat":36.959832929834775,"lng":128.46903794517021},{"lat":36.95977918835292,"lng":128.46899513714746},{"lat":36.95975724850404,"lng":128.46892183767338},{"lat":36.959744436907165,"lng":128.46883461182784},{"lat":36.95973397133036,"lng":128.46873618109137},{"lat":36.95976181582205,"lng":128.468638237024},{"lat":36.95980306800853,"lng":128.46855450400466},{"lat":36.95986671802115,"lng":128.4684879065598},{"lat":36.95989897817257,"lng":128.46840125101548},{"lat":36.959899802369485,"lng":128.46830015483522},{"lat":36.95990268524745,"lng":128.46822295786754},{"lat":36.95989456427864,"lng":128.4681133231357},{"lat":36.95990463148901,"lng":128.46798425918533},{"lat":36.959943972575765,"lng":128.46785837436727},{"lat":36.9599896622401,"lng":128.4677831218898},{"lat":36.96005781975977,"lng":128.46771658097782},{"lat":36.96010369244836,"lng":128.4676188631688},{"lat":36.96013613506818,"lng":128.4675097418264},{"lat":36.960152710557196,"lng":128.46741165347825},{"lat":36.96016491691877,"lng":128.4672966578028},{"lat":36.96016587722806,"lng":128.46717871235566},{"lat":36.96017371335342,"lng":128.4670468115723},{"lat":36.960188058393435,"lng":128.46694588572424},{"lat":36.96021578742458,"lng":128.46686198055707},{"lat":36.96023443338265,"lng":128.46678638689687},{"lat":36.96026250520927,"lng":128.4666603577025},{"lat":36.9602699740336,"lng":128.4665733881701},{"lat":36.96028649266855,"lng":128.46648232009733},{"lat":36.96031638345033,"lng":128.4664096758741},{"lat":36.96034408913148,"lng":128.4663285790714},{"lat":36.960353834654256,"lng":128.46623882932474},{"lat":36.96039287715677,"lng":128.46614944938355},{"lat":36.96043651757667,"lng":128.46604889395135},{"lat":36.96047993007843,"lng":128.4659764211118},{"lat":36.96049434219355,"lng":128.46586707070594},{"lat":36.96047943510803,"lng":128.46576015818437},{"lat":36.96044850215381,"lng":128.46568393687667},{"lat":36.96044235735995,"lng":128.46560802913496},{"lat":36.96042731322983,"lng":128.46551796566916},{"lat":36.960428033048046,"lng":128.46542950679753},{"lat":36.96042018308173,"lng":128.4652861725171},{"lat":36.9604279932805,"lng":128.46515707860607},{"lat":36.9604333905871,"lng":128.46504761374672},{"lat":36.96042756563482,"lng":128.46493239075554},{"lat":36.96041316048885,"lng":128.4647636968123},{"lat":36.96040535467641,"lng":128.46461474627566},{"lat":36.96039729915893,"lng":128.46449668719094},{"lat":36.96038447329541,"lng":128.46441086560853},{"lat":36.960378807300195,"lng":128.46427598394408},{"lat":36.96036886149417,"lng":128.46411296473048},{"lat":36.96034553187412,"lng":128.46393292418796},{"lat":36.96031484796397,"lng":128.46382581345276},{"lat":36.96027708399997,"lng":128.46375793353292},{"lat":36.960255186712565,"lng":128.4636790186709},{"lat":36.96022220279097,"lng":128.4635774959029},{"lat":36.96018277752196,"lng":128.4634365735144},{"lat":36.96014089383158,"lng":128.46332089550765},{"lat":36.96005389296259,"lng":128.46321026774226},{"lat":36.96000729594213,"lng":128.46311980794525},{"lat":36.95999201085964,"lng":128.46305923232538},{"lat":36.95997006729927,"lng":128.46298593534695},{"lat":36.95993004978529,"lng":128.4629180265004},{"lat":36.95988973555847,"lng":128.46288662520618},{"lat":36.959842615434006,"lng":128.46286075578297},{"lat":36.95979790770129,"lng":128.46281525626802},{"lat":36.95978973593821,"lng":128.4627112394813},{"lat":36.959795017455335,"lng":128.46261581653272},{"lat":36.959795745201696,"lng":128.46252595279597},{"lat":36.95979183034994,"lng":128.46245288311988},{"lat":36.95977676091033,"lng":128.4623656296593},{"lat":36.959761599906976,"lng":128.46228960876277},{"lat":36.95973084675544,"lng":128.46219092443732},{"lat":36.95969567706556,"lng":128.46208095065143},{"lat":36.95966046155062,"lng":128.4619765921004},{"lat":36.95963844871652,"lng":128.4619117195564},{"lat":36.95961443248759,"lng":128.4618159285623},{"lat":36.95959251101104,"lng":128.46173982359193},{"lat":36.95956822211068,"lng":128.46167773138018},{"lat":36.959550989556185,"lng":128.46157921731373},{"lat":36.959545024069264,"lng":128.4614808445602},{"lat":36.95953006817763,"lng":128.46137955036215},{"lat":36.95951533890107,"lng":128.46125017491647},{"lat":36.959516066507454,"lng":128.46116031147764},{"lat":36.95952353129596,"lng":128.46107334211797},{"lat":36.959524338267634,"lng":128.46097365049556},{"lat":36.95950951808514,"lng":128.46085550764104},{"lat":36.95950817323012,"lng":128.46074315070766},{"lat":36.959506942451775,"lng":128.4606167525864},{"lat":36.95950575628822,"lng":128.46048473931893},{"lat":36.9594908155355,"lng":128.46038133936426},{"lat":36.95948050181049,"lng":128.4602632524232},{"lat":36.95945441285917,"lng":128.46014496865942},{"lat":36.95944414363826,"lng":128.46002126553398},{"lat":36.9594337382654,"lng":128.4599144123181},{"lat":36.95942331088753,"lng":128.45981036670736},{"lat":36.959415340010274,"lng":128.4596810758382},{"lat":36.95940522996418,"lng":128.45953771652344},{"lat":36.959410690493335,"lng":128.45941982762324},{"lat":36.95940237890833,"lng":128.45933266036502},{"lat":36.95938942519131,"lng":128.45926228618723},{"lat":36.95938122751394,"lng":128.45916107667094},{"lat":36.95938010812502,"lng":128.4590206386597},{"lat":36.9593787724786,"lng":128.45890687753962},{"lat":36.959370620067375,"lng":128.45880005294302},{"lat":36.95938953352309,"lng":128.45869075823086},{"lat":36.959399431870935,"lng":128.45858135210986},{"lat":36.95941367858861,"lng":128.4584916579441},{"lat":36.95944586405698,"lng":128.45841342451865},{"lat":36.9594987617821,"lng":128.4582820881186},{"lat":36.95956245088458,"lng":128.45820986478176},{"lat":36.95962593673449,"lng":128.45816291623544},{"lat":36.95964883550383,"lng":128.45811826654568},{"lat":36.959658507396334,"lng":128.45803694133534},{"lat":36.95963899505543,"lng":128.45794120818},{"lat":36.95962824805693,"lng":128.4578764774998},{"lat":36.959653739528335,"lng":128.45778973348013},{"lat":36.95971537927496,"lng":128.45769220741496},{"lat":36.95979734660862,"lng":128.4575893202178},{"lat":36.95984284367358,"lng":128.45753722941933},{"lat":36.95991541074355,"lng":128.45748196858452},{"lat":36.95996997237603,"lng":128.45742367316888},{"lat":36.960029381514175,"lng":128.45732331046645},{"lat":36.9600550310008,"lng":128.45721690705227},{"lat":36.960098437313235,"lng":128.45714442935156},{"lat":36.960132649270534,"lng":128.4570943045374},{"lat":36.960164697352916,"lng":128.4570329175654},{"lat":36.96017873906337,"lng":128.45696849726633},{"lat":36.960190460318834,"lng":128.45691247364664},{"lat":36.96021845348302,"lng":128.4567948666944},{"lat":36.96024624365574,"lng":128.45670253253735},{"lat":36.960258303224876,"lng":128.45660438472765},{"lat":36.96027491523331,"lng":128.4565006772378},{"lat":36.96031631725436,"lng":128.45639728025174},{"lat":36.96035296296554,"lng":128.45632471684561},{"lat":36.96041703558451,"lng":128.4562047505547},{"lat":36.96046492651764,"lng":128.45613513619165},{"lat":36.960497019559654,"lng":128.45606813332762},{"lat":36.960540278814236,"lng":128.45601390794133},{"lat":36.96060394385595,"lng":128.45594449044543},{"lat":36.960669841015026,"lng":128.45587790878886},{"lat":36.96072440189036,"lng":128.4558196116445},{"lat":36.96078126125232,"lng":128.45575572636722},{"lat":36.9608133086625,"lng":128.45569433829894},{"lat":36.960841097987,"lng":128.45560200412416},{"lat":36.96088705083602,"lng":128.45549304497825},{"lat":36.96093049065893,"lng":128.45541635238172},{"lat":36.96100332844131,"lng":128.45532738937524},{"lat":36.96106692677771,"lng":128.45526639492525},{"lat":36.961126017125174,"lng":128.45520534488443},{"lat":36.9611850847288,"lng":128.455147103504},{"lat":36.961230608458365,"lng":128.4550915010238},{"lat":36.961287716307844,"lng":128.45499672291388},{"lat":36.96132875471939,"lng":128.4549382560344},{"lat":36.96139021148789,"lng":128.45486319224608},{"lat":36.961438101664115,"lng":128.4547935761502},{"lat":36.96149545714904,"lng":128.45466790670767},{"lat":36.96151188775909,"lng":128.4545866627501},{"lat":36.96156913046773,"lng":128.45447503464337},{"lat":36.96163079026505,"lng":128.45437469577269},{"lat":36.96170144139206,"lng":128.45427727747463},{"lat":36.961801434087974,"lng":128.4541746078148},{"lat":36.96185790967441,"lng":128.45415846074428},{"lat":36.961898857857356,"lng":128.45411122587367},{"lat":36.961921980165116,"lng":128.45403849136676},{"lat":36.96191792404525,"lng":128.45398226924027},{"lat":36.961895727212855,"lng":128.45393986271125},{"lat":36.96190086567113,"lng":128.45386128674141},{"lat":36.96191945899929,"lng":128.45379130443771},{"lat":36.96191103087249,"lng":128.45371817534416},{"lat":36.961884618928735,"lng":128.45363920603052},{"lat":36.96187621427119,"lng":128.4535632693423},{"lat":36.96185424217205,"lng":128.45349278072518},{"lat":36.961875335907244,"lng":128.45339193446318},{"lat":36.961909860945475,"lng":128.4533024905006},{"lat":36.96191969323846,"lng":128.45320080128747},{"lat":36.96194754775094,"lng":128.4531000395696},{"lat":36.961970804489724,"lng":128.4530104553276},{"lat":36.96199458044294,"lng":128.4528562790081},{"lat":36.962029353366496,"lng":128.45273594245805},{"lat":36.96206617719151,"lng":128.45264090978046},{"lat":36.96207798614619,"lng":128.4525736500005},{"lat":36.96207192356176,"lng":128.45248650849305},{"lat":36.96208857732482,"lng":128.45237718108112},{"lat":36.96208246931552,"lng":128.45229565603057},{"lat":36.96206279572641,"lng":128.45221957820044},{"lat":36.962032236118475,"lng":128.4520956199992},{"lat":36.96203998769308,"lng":128.45197213801234},{"lat":36.96205240368831,"lng":128.4518290553407},{"lat":36.96205569318935,"lng":128.4516999004358},{"lat":36.96208622757758,"lng":128.45154580804584},{"lat":36.962105156180684,"lng":128.45143369976662},{"lat":36.96212389377729,"lng":128.4513454617042},{"lat":36.96212492876557,"lng":128.4512162795726},{"lat":36.962130358512404,"lng":128.4511011944049},{"lat":36.96215622769936,"lng":128.45096670458688},{"lat":36.96215480663963,"lng":128.45086276889842},{"lat":36.96215577330014,"lng":128.45074201082969},{"lat":36.962172222948716,"lng":128.45065795755067},{"lat":36.962177573500036,"lng":128.4505527019253},{"lat":36.96218969585204,"lng":128.45044612523796},{"lat":36.962197265854584,"lng":128.45034510979582},{"lat":36.96221389506032,"lng":128.45023859047004},{"lat":36.96225204245229,"lng":128.44997786395686},{"lat":36.962268739087584,"lng":128.4498629191871},{"lat":36.9622972420406,"lng":128.44968071387257},{"lat":36.96230880814527,"lng":128.44957343580393},{"lat":36.96233183963765,"lng":128.44944171740266},{"lat":36.96235629387838,"lng":128.44934230847812},{"lat":36.9623843022389,"lng":128.4492218863906},{"lat":36.962387498643885,"lng":128.44910396481558},{"lat":36.96239071750105,"lng":128.44898323442152},{"lat":36.962402770755304,"lng":128.44888508355956},{"lat":36.96244409861366,"lng":128.4487901035631},{"lat":36.962449616241265,"lng":128.448663784678},{"lat":36.96244356749042,"lng":128.44857453578823},{"lat":36.96245334478866,"lng":128.4484791643759},{"lat":36.96247416550292,"lng":128.44841201705466},{"lat":36.962472584381956,"lng":128.44832773920191},{"lat":36.962489010701645,"lng":128.44824649270402},{"lat":36.96253029297278,"lng":128.4481571287397},{"lat":36.962564545425074,"lng":128.44810138169737},{"lat":36.96260557557853,"lng":128.448043611703},{"lat":36.962640141729075,"lng":128.4479485478371},{"lat":36.96265654435067,"lng":128.44787010987133},{"lat":36.96266199340154,"lng":128.44775221586372},{"lat":36.962656084120894,"lng":128.44764541446486},{"lat":36.96263482580997,"lng":128.4474850602438},{"lat":36.96261760401862,"lng":128.44738373731235},{"lat":36.962616223990615,"lng":128.44727418330956},{"lat":36.96260558289581,"lng":128.44719541067303},{"lat":36.96258137642568,"lng":128.447122087335},{"lat":36.96255730321957,"lng":128.44703191337172},{"lat":36.9625374695171,"lng":128.44697549576887},{"lat":36.9625086874163,"lng":128.44691054062594},{"lat":36.96244875835439,"lng":128.44679464538547},{"lat":36.96245188572285,"lng":128.44668514885348},{"lat":36.962427476365356,"lng":128.4466371006086},{"lat":36.962378256102376,"lng":128.44659155271023},{"lat":36.96230667782975,"lng":128.44652326067524},{"lat":36.962248464996016,"lng":128.4464747930581},{"lat":36.962203908326224,"lng":128.44640964431798},{"lat":36.962166089264585,"lng":128.44634738743616},{"lat":36.96211233931601,"lng":128.44630459260688},{"lat":36.9620810571619,"lng":128.4462705023378},{"lat":36.96207028130914,"lng":128.44620857980166},{"lat":36.962044021783626,"lng":128.44610995454656},{"lat":36.9620059119448,"lng":128.4460842055663},{"lat":36.96202636243674,"lng":128.4460633941186},{"lat":36.961979574047945,"lng":128.44599540897494},{"lat":36.961928098625435,"lng":128.44594983482912},{"lat":36.96184473818689,"lng":128.4459459946523},{"lat":36.96177746598504,"lng":128.44590303324702},{"lat":36.96173464751856,"lng":128.44590250412642},{"lat":36.961702874077474,"lng":128.44593019626984},{"lat":36.96167585328285,"lng":128.4459270534147},{"lat":36.961633079794545,"lng":128.44592090784408},{"lat":36.96154755442412,"lng":128.44590580680864},{"lat":36.96146417148206,"lng":128.44590477548746},{"lat":36.961392145721376,"lng":128.44589264919452},{"lat":36.961333709498156,"lng":128.44587226701776},{"lat":36.96122772286297,"lng":128.44587938179762},{"lat":36.96112851976251,"lng":128.4458837718779},{"lat":36.96102911606126,"lng":128.4459134363231},{"lat":36.960945352594,"lng":128.4459601449179},{"lat":36.96087963985058,"lng":128.4460042688695},{"lat":36.96081419609834,"lng":128.44601469333472},{"lat":36.96073297716734,"lng":128.4460249227119},{"lat":36.96063350594985,"lng":128.44606301194543},{"lat":36.96054757841681,"lng":128.4460984593918},{"lat":36.96044824124853,"lng":128.44611969825013},{"lat":36.96038953604063,"lng":128.44613301427827},{"lat":36.96033772503133,"lng":128.44612956532012},{"lat":36.96029278754807,"lng":128.4461121579289},{"lat":36.960248051594625,"lng":128.44606947646398},{"lat":36.96020115070415,"lng":128.44601553433043},{"lat":36.96016768283084,"lng":128.44597299198117},{"lat":36.96012736393138,"lng":128.44594159937122},{"lat":36.96008481442304,"lng":128.4459073711796},{"lat":36.95999955797694,"lng":128.44585857146828},{"lat":36.95993679276111,"lng":128.445815667269},{"lat":36.959871796023535,"lng":128.4457699275211},{"lat":36.959831701007474,"lng":128.44571045246752},{"lat":36.95977795075723,"lng":128.44566766056286},{"lat":36.95976715207037,"lng":128.4456085475679},{"lat":36.959761040245446,"lng":128.44552702540142},{"lat":36.95976157611809,"lng":128.44545962858},{"lat":36.95978250749576,"lng":128.44537844027437},{"lat":36.95980370670192,"lng":128.4452635529293},{"lat":36.95984050211248,"lng":128.44517132677558},{"lat":36.95986194644932,"lng":128.44502555009683},{"lat":36.959894569793114,"lng":128.44489114369668},{"lat":36.9599179434424,"lng":128.44478611341611},{"lat":36.95994362668151,"lng":128.4446740903765},{"lat":36.95997154134993,"lng":128.44456490284816},{"lat":36.959983501989726,"lng":128.44447798691985},{"lat":36.959977567216065,"lng":128.4443739981465},{"lat":36.9599758278143,"lng":128.44430938075405},{"lat":36.95998580186489,"lng":128.44418873770613},{"lat":36.960002671518254,"lng":128.44405132844213},{"lat":36.96002402563175,"lng":128.44391678376294},{"lat":36.96003632058864,"lng":128.44378774349204},{"lat":36.96006644356442,"lng":128.44368419977533},{"lat":36.96009451256424,"lng":128.4435553539265},{"lat":36.96012688932406,"lng":128.44345183799177},{"lat":36.96016591400052,"lng":128.44336244720265},{"lat":36.9602252666385,"lng":128.4432676892625},{"lat":36.96024840477475,"lng":128.44319214409532},{"lat":36.9602537818391,"lng":128.44308267838434},{"lat":36.960254718097005,"lng":128.44296473168797},{"lat":36.96028024362313,"lng":128.4428723652798},{"lat":36.960323463840325,"lng":128.44282234436335},{"lat":36.96036233205627,"lng":128.44275261082313},{"lat":36.96037851965366,"lng":128.44270085249738},{"lat":36.96039045654075,"lng":128.44261674338736},{"lat":36.96040696766689,"lng":128.44252426499966},{"lat":36.96043017254915,"lng":128.44244029543768},{"lat":36.960462525057196,"lng":128.44233958615058},{"lat":36.96046995460994,"lng":128.44225542217586},{"lat":36.96047986029222,"lng":128.44214320313458},{"lat":36.960501167492716,"lng":128.4420142722565},{"lat":36.96053153437783,"lng":128.44187983656923},{"lat":36.960525441487086,"lng":128.44179550615888},{"lat":36.960501476086705,"lng":128.44169129471072},{"lat":36.96048634654371,"lng":128.44160966038095},{"lat":36.96046010550285,"lng":128.44150822989727},{"lat":36.960411149045505,"lng":128.4414289882451},{"lat":36.96038044553598,"lng":128.44132188578664},{"lat":36.960347231030845,"lng":128.44124705153197},{"lat":36.96031407288371,"lng":128.4411651955059},{"lat":36.96028992881838,"lng":128.4410834510707},{"lat":36.96026359783183,"lng":128.44099325371405},{"lat":36.96025315292396,"lng":128.4408892101009},{"lat":36.96025187865042,"lng":128.4407656190943},{"lat":36.960264036907546,"lng":128.44065342800823},{"lat":36.9602804794191,"lng":128.44056937438566},{"lat":36.960315061973205,"lng":128.44047150105786},{"lat":36.960340785008306,"lng":128.44035385835923},{"lat":36.96034594843814,"lng":128.44027107079162},{"lat":36.96036015995639,"lng":128.44018418040253},{"lat":36.96035645305455,"lng":128.44008302792304},{"lat":36.9603279790481,"lng":128.43997876262063},{"lat":36.96029048990336,"lng":128.4398743859973},{"lat":36.96026636728955,"lng":128.4397898332284},{"lat":36.96021982003558,"lng":128.4396909629096},{"lat":36.96016635526017,"lng":128.43961166696144},{"lat":36.96009035503781,"lng":128.43953209502524},{"lat":36.96002138205753,"lng":128.43941890646434},{"lat":36.95998608028957,"lng":128.43932298343606},{"lat":36.95994430587838,"lng":128.43919046915025},{"lat":36.95990938076396,"lng":128.43904680692464},{"lat":36.959863232894996,"lng":128.43889738830913},{"lat":36.95980804744566,"lng":128.43875066845249},{"lat":36.959795041738595,"lng":128.438685210544},{"lat":36.95977091825594,"lng":128.4386006586753},{"lat":36.95973559259045,"lng":128.43850754502324},{"lat":36.95969805839649,"lng":128.43840878622717},{"lat":36.95966962751203,"lng":128.43829890497165},{"lat":36.95963233669611,"lng":128.43816925606433},{"lat":36.9596021971176,"lng":128.43801349176127},{"lat":36.95958514102952,"lng":128.43786560162658},{"lat":36.95957394938345,"lng":128.4377369850166},{"lat":36.9595443744309,"lng":128.4376776302111},{"lat":36.95949057770756,"lng":128.43756930693772},{"lat":36.959452798441234,"lng":128.43750143911},{"lat":36.95938815313511,"lng":128.4374107751307},{"lat":36.95931692497239,"lng":128.4372975617184},{"lat":36.95922559082505,"lng":128.43716163459504},{"lat":36.95915208703991,"lng":128.43705120260063},{"lat":36.9591234989228,"lng":128.43696098124323},{"lat":36.95910631254612,"lng":128.43685404766822},{"lat":36.959109540207166,"lng":128.4367305139277},{"lat":36.95906109081687,"lng":128.4365866878314},{"lat":36.95899697732826,"lng":128.43642862760757},{"lat":36.958961500781456,"lng":128.43635447062775},{"lat":36.95890156108455,"lng":128.43623858879053},{"lat":36.9588165443259,"lng":128.43615891055805},{"lat":36.95874007701262,"lng":128.4361383146421},{"lat":36.95867028172992,"lng":128.43612903558156},{"lat":36.958616571477634,"lng":128.43608063359795},{"lat":36.958565513046366,"lng":128.43598171212992},{"lat":36.95852552422879,"lng":128.43590820306588},{"lat":36.95847227840653,"lng":128.4358008291927},{"lat":36.95843233306258,"lng":128.4357217040678},{"lat":36.95840840670522,"lng":128.43561188099687},{"lat":36.95837526679859,"lng":128.4355272218399},{"lat":36.95832856019422,"lng":128.4354480138108},{"lat":36.95829053684439,"lng":128.43541103782715},{"lat":36.95821912969,"lng":128.435320293859},{"lat":36.95816323179112,"lng":128.4352634412644},{"lat":36.95809878388156,"lng":128.43514750719567},{"lat":36.95804591344554,"lng":128.43499239502756},{"lat":36.95801543600422,"lng":128.43485581296449},{"lat":36.95798945393505,"lng":128.43472068958351},{"lat":36.95798806205755,"lng":128.434611143178},{"lat":36.95794811589342,"lng":128.43453201915796},{"lat":36.95789261569203,"lng":128.43442461935382},{"lat":36.95786221396971,"lng":128.4342782096988},{"lat":36.957872399875065,"lng":128.4341294862645},{"lat":36.95791444425632,"lng":128.43394183451176},{"lat":36.95791983494138,"lng":128.43382956254524},{"lat":36.95795914012591,"lng":128.4337036621736},{"lat":36.95799358475071,"lng":128.43362263822314},{"lat":36.95801243071995,"lng":128.43351895578812},{"lat":36.958022261529024,"lng":128.4334151626771},{"lat":36.95801383224944,"lng":128.43334063595452},{"lat":36.95804885079252,"lng":128.43318659883647},{"lat":36.95806548675685,"lng":128.43307727235197},{"lat":36.95808638661674,"lng":128.43299889080748},{"lat":36.958114114048,"lng":128.43291216726308},{"lat":36.95812626485965,"lng":128.43279997668463},{"lat":36.958140867309396,"lng":128.4326625412823},{"lat":36.95815297353261,"lng":128.43255596795217},{"lat":36.958164836704796,"lng":128.4324802843374},{"lat":36.95821960721002,"lng":128.43239388973322},{"lat":36.95831010367973,"lng":128.4323500580643},{"lat":36.95840303055545,"lng":128.43228378785744},{"lat":36.958446070007255,"lng":128.43225622807674},{"lat":36.95852101189623,"lng":128.43218412158038},{"lat":36.95857350603542,"lng":128.43210050742454},{"lat":36.95861700809509,"lng":128.432013975147},{"lat":36.95868523397561,"lng":128.4319361691819},{"lat":36.958728404494636,"lng":128.4318917591819},{"lat":36.95878503159141,"lng":128.431855939754},{"lat":36.95881918789418,"lng":128.43181142035368},{"lat":36.95888975534651,"lng":128.43172240906148},{"lat":36.958992026521486,"lng":128.4316141242163},{"lat":36.95906016356325,"lng":128.43154755007757},{"lat":36.95914882563152,"lng":128.43145033290722},{"lat":36.95922630711032,"lng":128.43134174606107},{"lat":36.95927637136,"lng":128.43128056817835},{"lat":36.959331052457046,"lng":128.43120540518206},{"lat":36.95937919291127,"lng":128.431102076645},{"lat":36.9594043626498,"lng":128.4310539370209},{"lat":36.95945007279936,"lng":128.4309730470814},{"lat":36.95948690151014,"lng":128.43087519778678},{"lat":36.95952366374691,"lng":128.43078577343238},{"lat":36.95954686039747,"lng":128.43070179986992},{"lat":36.95957898265034,"lng":128.43062917030358},{"lat":36.95960905000041,"lng":128.4305312379572},{"lat":36.95965288097418,"lng":128.4304025805475},{"lat":36.95969447994068,"lng":128.43027108669054},{"lat":36.95972021593035,"lng":128.4301506335836},{"lat":36.959748579004284,"lng":128.42998246737156},{"lat":36.959773961843766,"lng":128.4299069470328},{"lat":36.95979757610916,"lng":128.429769617094},{"lat":36.959818716094425,"lng":128.42966034123666},{"lat":36.95983752505909,"lng":128.42956086833985},{"lat":36.95985875324698,"lng":128.42944035967292},{"lat":36.95988669730899,"lng":128.4293255498727},{"lat":36.9599079252473,"lng":128.42920504217795},{"lat":36.959926876985875,"lng":128.4290873144916},{"lat":36.959945806515194,"lng":128.42897239548032},{"lat":36.95994896066422,"lng":128.42885728376345},{"lat":36.959938505974364,"lng":128.42875324190197},{"lat":36.959916650522324,"lng":128.42866591266431},{"lat":36.959899143606876,"lng":128.42859899793277},{"lat":36.95988197085021,"lng":128.4284892572675},{"lat":36.95987617655595,"lng":128.4283656116297},{"lat":36.95986333501296,"lng":128.42827839145207},{"lat":36.959859443179596,"lng":128.4281997064164},{"lat":36.959860342580484,"lng":128.42808456726772},{"lat":36.959863386430385,"lng":128.4279834981845},{"lat":36.9598594723463,"lng":128.42790762076996}]]}}
  ];

  res.json(DUMMY_DATA);
});

/**
 * @desc  This function returns important spot's coordinates converted from 
 *        TM projection to GRS80 Projection(degrees).
 *        HTTP request URL = host:3000/spots/{mntCode}/{fid}
 * 
 * @param String req.params.mntCode   Mountain's serial code.
 * @param String req.params.fid       Feature's ID.
 * 
 * @var   Array   coordinateFilePath  Coordinate file path in local storage.
 * @var   Array   coordinateFiles     Coordinate file list in local storage.
 * @var   String  mntFileName         Selected file name.
 * @var   Array   coordinateFile      JSON Object in local storage.
 *                                    This contains short description that hiking path.
 * @var   Array   mntPaths            Coordinates list in local file.
 * 
 * @return  null
 *          HTTP Response = String    The String is formatted by JSON syntax.
 */
router.get('/spots/:mntCode/:fid?', function(req, res, next) {
  var mntCode = req.params.mntCode;
  var fid     = req.params.fid;

  var coordinateFilePath = `public/mountain/${mntCode}_geojson`;

  // Hiking path files path in local
  var coordinateFiles = fs.readdirSync(coordinateFilePath);
  
  var mntFileName;
  
  for (let idx in coordinateFiles) {
    let fileName = coordinateFiles[idx];

    if (fileName.match(/^PMNTN_SPOT_/)) {
      mntFileName = fileName;
    }
  }

  var coordinateFile = JSON.parse(fs.readFileSync(`${coordinateFilePath}/${mntFileName}`, 'utf8'));

  res.send(convert(coordinateFile['features'], fid));
});

/**
 * @function      This function returns safe spot's coordinates converted from 
 *                TM projection to GRS80 Projection(degrees).
 *                HTTP request URL = host:3000/paths/{mntCode}/{fid}
 * 
 * @param String  req.params.mntCode   Mountain's serial code.
 * @param String  req.params.fid       Feature's ID.
 * 
 * @var   Array   coordinateFilePath  Coordinate file path in local storage.
 * @var   Array   coordinateFiles     Coordinate file list in local storage.
 * @var   String  mntFileName         Selected file name.
 * @var   Array   coordinateFile      JSON Object in local storage.
 *                                    This contains short description that hiking path.
 * @var   Array   mntPaths            Coordinates list in local file.
 * 
 * @return  null
 *          HTTP Response = String    The String is formatted by JSON syntax.
 */
router.get('/safe-spot/:mntCode/:fid?', function(req, res, next) {
  var mntCode = req.params.mntCode;
  var fid     = req.params.fid;

  var coordinateFilePath = `public/mountain/${mntCode}_geojson`;
  // Hiking path files path in local
  var coordinateFiles = fs.readdirSync(coordinateFilePath);
  
  var mntFileName;
  
  for (let idx in coordinateFiles) {
    let fileName = coordinateFiles[idx];

    if (fileName.match(/^PMNTN_SAFE_SPOT_/)) {
      mntFileName = fileName;
    }
  }

  var coordinateFile = JSON.parse(fs.readFileSync(`${coordinateFilePath}/${mntFileName}`, 'utf8'));

  res.send(convert(coordinateFile['features'], fid));
});

/**
 * @author    bs Kwon <rnjs9957@gmail.com>
 * 
 * @desc      This function returns coordinate 
 *            that converted from PM projection to GRS80 projection(degrees).
 * 
 * @requires  proj4 (NPM Package)
 * 
 * @param     Array     features      Coordinate set provided by Korea Forest Service.
 * @param     Number    fid           Coordinate feature's ID in data set.
 * 
 * @constant  String    KTM_PROJ      K-TM projection = coordinate measure method that uses in Korea.
 * @constant  String    EPSG4019      GRS80(Geodetic Reference System) https://en.wikipedia.org/wiki/GRS_80
 * 
 * @return    Array                   Converted coordinate set.
 */
var convert = function(features, fid) {
  // KTM Projectrion Setting (Korean)
  const KTM_PROJ = '+proj=tmerc +lat_0=38 +lon_0=127 +k=1 +x_0=200000 +y_0=600000 +ellps=GRS80 +units=m +no_defs';
  // GRS80 Projection Setting
  const EPSG4019 = '+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs';

  for (let idx in features) {
    if (fid != undefined && fid != idx) continue;

    let x = parseFloat(features[idx]['geometry']['x']);
    let y = parseFloat(features[idx]['geometry']['y']);


    let convertedPosition = proj4(KTM_PROJ, EPSG4019).forward([x, y]);

    features[idx]['geometry'] = {
      lat: convertedPosition[1],
      lng: convertedPosition[0],
    };
  }

  if (fid == undefined) {
    return features;
  } else {
    return features[fid];
  }
}

module.exports = router;